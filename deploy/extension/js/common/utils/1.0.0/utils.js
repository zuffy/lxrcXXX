define("common/utils/1.0.0/utils",["gallery/jquery/1.0.0/jquery"],function(a){var e,b=a("gallery/jquery/1.0.0/jquery"),c=0,f={debug:c,isUA:function(a){a=a.replace("ie","MSIE ");var b=window.navigator.userAgent.toLowerCase(),c=new RegExp(a,"i");return c.test(b)},inArray:function(a,b){if("undefined"!=typeof a.indexOf)return a.indexOf(b)>-1;for(var c=a.length-1;c>=0;c--)if(a[c]==b)return!0;return!1},decode:function(a){var b="";try{b=decodeURIComponent(decodeURIComponent(a))}catch(c){try{b=decodeURIComponent(a)}catch(c){b=a}}return b},encode:function(a){return encodeURIComponent(a)},isLogin:function(){var a=this.getCookie("userid"),b=this.getCookie("sessionid")&&a;return b},getCookie:function(a){return null==document.cookie.match(new RegExp("(^"+a+"| "+a+")=([^;]*)"))?"":decodeURIComponent(RegExp.$2)},setCookie:function(a,b,c){var d=document.location.host;if(arguments.length>2){var e=new Date((new Date).getTime()+1e3*c);document.cookie=a+"="+escape(b)+"; path=/; domain="+d+"; expires="+e.toGMTString()}else document.cookie=a+"="+escape(b)+"; path=/; domain="+d},setGdCookie:function(a,b,c){if(arguments.length>2){var d=new Date((new Date).getTime()+1e3*c);document.cookie=a+"="+escape(b)+"; path=/; domain=xunlei.com; expires="+d.toGMTString()}else document.cookie=a+"="+escape(b)+"; path=/; domain=xunlei.com"},getFileName:function(a){var b=this,c=b.decode(a);if(0===c.indexOf("ed2k")){var d=c.substr(c.indexOf("ed2k://|file|")+13,c.length);return d.substr(0,d.indexOf("|"))}return 0===c.indexOf("thunder")?a:-1!=c.lastIndexOf("/")?c.substr(c.lastIndexOf("/")+1,c.length):c},getFileExt:function(a){var b=this.decode(a);return b.substr(b.lastIndexOf(".")+1,b.length)},toShortName:function(a,b,c,d){for(var e=0,f=0;a.length>e;++e,++f)a.charCodeAt(e)>255&&++f;if(b>=f)return a;for(var e=0,f=0;c>e;++e,++f)a.charCodeAt(f)>255&&++e;for(var g=a.substr(0,f),e=0,f=0;d>e;++e,++f){var h=a.length-f-1;a.charCodeAt(h)>255&&++e}var i=a.substring(a.length-f);return g+" ... "+i},getCurrentThunder:function(){var a=this.getCookie("userid")||e;return a&&this.setCookie("userid",a,1296e3),g.getInstance()},log:function(a){this.debug&&console.log(a)}},g={getInstance:function(){for(var a=[g.Thunder5,g.WebThunder,g.Mac],b=0;a.length>b;b++)try{return a[b].getInstance()}catch(c){continue}return null},setParameter:function(){for(var f=["thunder_cid","thunder_down_url","thunder_down_pageurl","thunder_stat_pageurl"],g=0;f.length>g;g++){var h=b(f[g]);(isUndef(h)||isNull(h))&&(h=document.createElement("input"),h.type="hidden",h.id=f[g],document.body.appendChild(h)),h.value=arguments[g]}},download:function(a,b,c,d,e){this.getInstance().download(a,b,c,d,e)},batchDownload:function(a,b){this.getInstance().batchDownload(a,b)}},h={create:function(){return function(){this.initialize.apply(this,arguments)}}};g.WebThunder=h.create(),g.WebThunder.getInstance=function(){return new g.WebThunder},g.WebThunder.prototype={initialize:function(){this.__thunder=new ActiveXObject("ThunderServer.webThunder.1")},getVersion:function(){return parseInt(this.__thunder.GetVersion().split(".")[3])},_whd:function(a){return a.replace(/<br>/g,"\n").replace(/&lt/g,"<").replace(/&gt/g,">").replace(/&quot/g,'"').replace(/&apos/g,"'").replace(/&amp/g,"&")},download:function(a,b,c,d,e){return this.__thunder.CallAddTask(this._whd(b),d,this._whd(c),1,a,e),0},batchDownload:function(a,b){var c=this.__thunder.BeginBatchTask();if(0==c)return alert("批量下载初始化失败"),void 0;for(var d=this.getVersion(),e=0;a.length>e;e++)43>d?this.__thunder.AddTaskToBatch(c,a[e].url,a[e].name,a[e].refer):54>d?this.__thunder.AddTaskToBatch(c,a[e].url,a[e].name,a[e].refer,a[e].cid):this.__thunder.AddTaskToBatch(c,a[e].url,a[e].name,a[e].refer,a[e].cid,b);this.__thunder.EndBatchTask(c)}};var j={create:function(a,b){var c=function(){var a=arguments.callee.target,b=arguments.callee.func;return b.apply(a,arguments)};return c.target=a,c.func=b,c}};return g.Thunder5=h.create(),g.Thunder5.getInstance=function(){return"undefined"==typeof this._thunder&&(this._thunder=new g.Thunder5),this._thunder},g.Thunder5.prototype={initialize:function(){this.__thunder=new ActiveXObject("ThunderAgent.Agent.1")},download:function(a,b,c,d,e,f){try{this.addTask(a,b,c,d,e,f),this.commitTasks()}catch(g){alert("请安装迅雷7")}},batchDownload:function(a,b){try{for(i=0;a.length>i;i++)this.addTask(a[i].cid,a[i].url,a[i].refer,a[i].name,b);this.commitTasks()}catch(c){alert(c.message)}},addTask:function(a,b,c,d,e){for(var g=[j.create(this,function(){this.__thunder.AddTask4(b,d,"",d,c,-1,0,-1,"",a,e)}),j.create(this,function(){this.__thunder.AddTask3(b,d,"",d,c,-1,0,-1,"",a)}),j.create(this,function(){this.__thunder.AddTask2(b,d,"",d,c,-1,0,-1,"")}),j.create(this,function(){this.__thunder.AddTask(b,d,"",d,c,-1,0,-1)})],h=0;g.length>h;h++)try{return g[h](),void 0}catch(i){}throw"不支持此方法，请安装最新的迅雷客户端"},commitTasks:function(){for(var a=[j.create(this,function(){this.__thunder.CommitTasks2(1)}),j.create(this,function(){this.__thunder.CommitTasks()})],b=0;a.length>b;b++)try{return a[b](),void 0}catch(c){}throw"不支持此方法，请安装最新的迅雷客户端"}},g.Mac=h.create(),g.Mac.getInstance=function(){if(-1!=navigator.platform.indexOf("Mac"))return new g.Mac;throw new Error("Not Mac")},g.Mac.prototype={initialize:function(){},download:function(a,b,c,d){try{var g=c,h=document.cookie,i=d,j=navigator.userAgent.toLowerCase(),k=/chrome/i.test(j)&&/webkit/i.test(j)&&/mozilla/i.test(j),l=/webkit/i.test(j)&&!(/chrome/i.test(j)&&/webkit/i.test(j)&&/mozilla/i.test(j));if(k||l){var m=document.getElementById("xunlei_com_thunder_helper_plugin_d462f475-c18e-46be-bd10-327458d045bd");if(null!=m&&null!=m.DownloadLixian&&void 0!=m.DownloadLixian){var n=m.DownloadLixian(b,g,h,i);if(n)return}else location.href=b}else if(/firefox/i.test(j)){var m=document.getElementById("xunlei_com_thunder_helper_plugin_d462f475-c18e-46be-bd10-327458d045bd");if(null!=m){var o=document.createElement("ThunderExtensionDataElement");o.setAttribute("url",b),o.setAttribute("refer_url",g),o.setAttribute("filename",i),o.setAttribute("cookie",h),document.documentElement.appendChild(o);var p=document.createEvent("Events");p.initEvent("ThunderDownloadLixianExtensionEvent",!0,!1),o.dispatchEvent(p)}else location.href=b}}catch(q){alert("请安装Mac迅雷")}},batchDownload:function(a,b){try{for(i=0;a.length>i;i++)this.download(a[i].cid,a[i].url,a[i].refer,a[i].name,b)}catch(c){alert(c.message)}}},f});